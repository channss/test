import json
from itertools import combinations

asdf = {"version":1,"partitions":[{"topic":"data-metric","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"data-metric","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":2,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":3,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":4,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":5,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":6,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"data-ml.style-matching","partition":7,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"data-webhook","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"data-webhook","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"follow-nest-api-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"follow-nest-api-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"gigs-api-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"gigs-api-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"gigs-cdc-nw","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"gigs-cdc-nw","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"indexer.company.v1","partition":0,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"indexer.company.v1","partition":1,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"kreditjob-api-dev-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"kreditjob-api-dev-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"kreditjob-api-dev2-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"kreditjob-api-dev2-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"kreditjob-cdc-nw","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"kreditjob-cdc-nw","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"kreditjob-server-dev-log","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"kreditjob-server-dev-log","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"learning-cdc-nw","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"learning-cdc-nw","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"oneid-backend-celery-dev-dev-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"oneid-backend-celery-dev-dev-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"oneid-cdc-nw","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"oneid-cdc-nw","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"pie-openapi-web-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"pie-openapi-web-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"pie-wanted-web-green-log","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"pie-wanted-web-green-log","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"pie-wanted-web-nextweek-log","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"pie-wanted-web-nextweek-log","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"python2-wanted-web-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"python2-wanted-web-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"rabbitmq-stomp-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"rabbitmq-stomp-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-company-nextweek-log","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-company-nextweek-log","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-event-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-event-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-position-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-position-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-tag-nextweek-log","partition":0,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"searchdog-poodle-tag-nextweek-log","partition":1,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"sns-nest-api-dev-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"sns-nest-api-dev-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"sns-nest-api-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"sns-nest-api-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"userweb-green-log","partition":0,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"userweb-green-log","partition":1,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"userweb-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"userweb-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"wanted-cdc-nw","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"wanted-cdc-nw","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"wanted-lottery-consumer-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"wanted-lottery-consumer-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"wanted-oneid-backend-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"wanted-oneid-backend-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"wanted-wpoint-consumer-nextweek-log","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"wanted-wpoint-consumer-nextweek-log","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"wanteddev-cdc-nw","partition":0,"replicas":[3,2,1],"log_dirs":["any","any","any"]},{"topic":"wanteddev-cdc-nw","partition":1,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"weaver-event-nw","partition":0,"replicas":[2,1,3],"log_dirs":["any","any","any"]},{"topic":"weaver-event-nw","partition":1,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"your-topic-name","partition":0,"replicas":[1,2,3],"log_dirs":["any","any","any"]},{"topic":"your-topic-name","partition":1,"replicas":[3,2,1],"log_dirs":["any","any","any"]}]}

BROKERS = [1, 2, 3, 4]
REPLICATION_FACTOR = 3
LOG_DIRS = ["any" for _ in range(REPLICATION_FACTOR)]
SETS = [list(c) for c in combinations(BROKERS, REPLICATION_FACTOR)]


if __name__ == '__main__':
    assignment = []
    for i in range(len(asdf['partitions'])):
        num = i % len(SETS)
        assignment.append(SETS[num])

    partitions = []
    for p in zip(asdf['partitions'], assignment):
        p[0]["replicas"] = p[1]
        p[0]["log_dirs"] = LOG_DIRS
        partitions.append(p[0])

    output = json.dumps({"version": 1, "partitions": partitions})
